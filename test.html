<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.3.0/d3.js"></script>
</head>

<body>
    <div id="chart">

        <script type="text/javascript">
            var width = 1000,
                height = 250,
                margin = 7,
                nRect = 11,
                rectWidth = (width - (nRect - 1) * margin) / nRect,

                svgContainer = d3.select('#chart').append('svg')
                    .attr('width', width)
                    .attr('height', height),

                svgWalkway = d3.select('#chart').append('svg')
                    .attr('width', '1000')
                    .attr('height', '150'),

                svgContainer2 = d3.select('#chart').append('svg')
                    .attr('width', width)
                    .attr('height', height);


            // Rectangles scaling

            var firstRow = d3.range(nRect),
                posxScale = d3.scaleLinear()
                    .domain(d3.extent(firstRow))
                    .range([0, width - rectWidth]);

            var middleRow = d3.range(1),
                posxScale3 = d3.scaleLinear()
                    .domain(d3.extent(middleRow))
                    .range([0, width - rectWidth]);


            var secondRow = d3.range(nRect),
                posxScale2 = d3.scaleLinear()
                    .domain(d3.extent(secondRow))
                    .range([0, width - rectWidth]);


            //Drawing the actual objects HTML rects

            var data = svgContainer.selectAll('rect.up')
                .data(firstRow);

            var testIndex = function(d, i, arr) {
                return i == 5 || d == 10 || (i > 0 && arr[i - 1]['__data__'] == 7);  
            }
            data
                .enter()
                .each(function (d, i, arr) {
                    t = d3.select(this);

                    t
                        .append('rect')
                        .attr('id', function (d) { return 'rectup' + i; })
                        .attr('x', posxScale)
                        .attr('width', rectWidth)
                        .attr('height', height)
                        .attr('class', 'up');
                    if (!testIndex(d, i, arr)) {
                        return;
                    }
                    t
                        .append('rect')
                        .attr('id', 'redrect')
                        .attr('x', posxScale)
                        .attr('width', '20')
                        .attr('height', '40');
                });
            data
                .exit()
                .remove();
            svgWalkway.selectAll('rect.middle')
                .data(middleRow)
                .enter()
                .append('rect')
                .attr('x', posxScale3)
                .attr('width', '1000')
                .attr('height', '150')
                .attr('class', 'middle');


            svgContainer2.selectAll('rect.down')
                .data(secondRow)
                .enter()
                .append('rect')
                .attr('id', function (d, i) { return "rectdown" + i })
                .attr('x', posxScale2)
                .attr('width', rectWidth)
                .attr('height', height)
                .attr('class', 'down')
                .attr('y', 0)
                .append('rect', function (d, i) { return "#rectdown" + i + '.down' })
                .attr('x', posxScale3)
                .attr('width', '1000')
                .attr('height', '150')
                .attr('class', 'middle');
        </script>
    </div>
</body>

</html>